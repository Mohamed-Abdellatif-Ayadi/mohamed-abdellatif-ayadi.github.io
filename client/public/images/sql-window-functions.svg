<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="500" viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#4338ca" stop-opacity="0.1"/>
      <stop offset="100%" stop-color="#3730a3" stop-opacity="0.3"/>
    </linearGradient>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#4338ca"/>
      <stop offset="100%" stop-color="#6366f1"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#1e1b4b" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect x="0" y="0" width="800" height="500" fill="#f8fafc" />
  <rect x="80" y="80" width="640" height="340" rx="16" fill="url(#bgGradient)" />
  
  <!-- Main SQL Window -->
  <g filter="url(#shadow)" transform="translate(100, 100)">
    <!-- DB Table Window -->
    <rect x="0" y="0" width="600" height="300" rx="10" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" />
    
    <!-- Header Bar -->
    <rect x="0" y="0" width="600" height="40" rx="10 10 0 0" fill="url(#headerGradient)" />
    <text x="20" y="25" font-family="monospace" font-size="16" font-weight="bold" fill="#ffffff">SQL Window Functions</text>
    
    <!-- Table -->
    <g transform="translate(20, 60)">
      <!-- Table Headers -->
      <rect x="0" y="0" width="560" height="30" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1" />
      <text x="15" y="20" font-family="monospace" font-size="14" fill="#475569">employee_id</text>
      <text x="150" y="20" font-family="monospace" font-size="14" fill="#475569">department</text>
      <text x="290" y="20" font-family="monospace" font-size="14" fill="#475569">salary</text>
      <text x="430" y="20" font-family="monospace" font-size="14" fill="#475569">dept_avg</text>
      
      <!-- Data Rows -->
      <g>
        <rect x="0" y="30" width="560" height="30" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="50" font-family="monospace" font-size="14" fill="#334155">1001</text>
        <text x="150" y="50" font-family="monospace" font-size="14" fill="#334155">Engineering</text>
        <text x="290" y="50" font-family="monospace" font-size="14" fill="#334155">85000</text>
        <text x="430" y="50" font-family="monospace" font-size="14" fill="#4338ca">90000</text>
      </g>
      <g>
        <rect x="0" y="60" width="560" height="30" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="80" font-family="monospace" font-size="14" fill="#334155">1002</text>
        <text x="150" y="80" font-family="monospace" font-size="14" fill="#334155">Engineering</text>
        <text x="290" y="80" font-family="monospace" font-size="14" fill="#334155">95000</text>
        <text x="430" y="80" font-family="monospace" font-size="14" fill="#4338ca">90000</text>
      </g>
      <g>
        <rect x="0" y="90" width="560" height="30" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="110" font-family="monospace" font-size="14" fill="#334155">1003</text>
        <text x="150" y="110" font-family="monospace" font-size="14" fill="#334155">Marketing</text>
        <text x="290" y="110" font-family="monospace" font-size="14" fill="#334155">75000</text>
        <text x="430" y="110" font-family="monospace" font-size="14" fill="#4338ca">77500</text>
      </g>
      <g>
        <rect x="0" y="120" width="560" height="30" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="140" font-family="monospace" font-size="14" fill="#334155">1004</text>
        <text x="150" y="140" font-family="monospace" font-size="14" fill="#334155">Marketing</text>
        <text x="290" y="140" font-family="monospace" font-size="14" fill="#334155">80000</text>
        <text x="430" y="140" font-family="monospace" font-size="14" fill="#4338ca">77500</text>
      </g>
      <g>
        <rect x="0" y="150" width="560" height="30" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="170" font-family="monospace" font-size="14" fill="#334155">1005</text>
        <text x="150" y="170" font-family="monospace" font-size="14" fill="#334155">Sales</text>
        <text x="290" y="170" font-family="monospace" font-size="14" fill="#334155">98000</text>
        <text x="430" y="170" font-family="monospace" font-size="14" fill="#4338ca">89000</text>
      </g>
      <g>
        <rect x="0" y="180" width="560" height="30" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" />
        <text x="15" y="200" font-family="monospace" font-size="14" fill="#334155">1006</text>
        <text x="150" y="200" font-family="monospace" font-size="14" fill="#334155">Sales</text>
        <text x="290" y="200" font-family="monospace" font-size="14" fill="#334155">80000</text>
        <text x="430" y="200" font-family="monospace" font-size="14" fill="#4338ca">89000</text>
      </g>
    </g>
    
    <!-- SQL Query -->
    <g transform="translate(20, 250)">
      <rect x="0" y="0" width="560" height="40" rx="6" fill="#1e1b4b" />
      <text x="15" y="25" font-family="monospace" font-size="14" fill="#f8fafc">SELECT *, AVG(salary) OVER (PARTITION BY department) AS dept_avg</text>
    </g>
  </g>
  
  <!-- Window Function Visual Elements -->
  <g transform="translate(400, 380)">
    <!-- Engineering partition -->
    <rect x="-220" y="0" width="140" height="70" rx="8" fill="#4338ca" fill-opacity="0.1" stroke="#4338ca" stroke-width="2" stroke-dasharray="5,5" />
    <text x="-150" y="40" font-family="Arial" font-size="14" fill="#4338ca" text-anchor="middle">PARTITION BY</text>
    
    <!-- Marketing partition -->
    <rect x="-50" y="0" width="140" height="70" rx="8" fill="#818cf8" fill-opacity="0.1" stroke="#818cf8" stroke-width="2" stroke-dasharray="5,5" />
    <text x="20" y="40" font-family="Arial" font-size="14" fill="#4c1d95" text-anchor="middle">department</text>
    
    <!-- Sales partition -->
    <rect x="120" y="0" width="140" height="70" rx="8" fill="#4338ca" fill-opacity="0.1" stroke="#4338ca" stroke-width="2" stroke-dasharray="5,5" />
    <text x="190" y="40" font-family="Arial" font-size="14" fill="#4338ca" text-anchor="middle">OVER()</text>
  </g>
</svg>